## 1. 介绍

TLS协议的主要目标是保护两个应用之间传输数据的私密性和完整性。此协议由两层组成：TLS记录协议和TLS握手协议。最底层是构建于一些可靠传输协议（例如TCP）之上的TLS记录协议。TLS记录协议在两方面保证了连接的安全性：

- 连接是私密的。协议使用对称加密算法（例如AES，RC4等）加密数据。每个连接使用的对称加密的Key是唯一生成的，并且使用另一个协议（例如TLS握手协议）来加密传输。记录协议也可以不加密使用。

- 连接是可靠的。消息在传输过程中会使用keyed MAC进行完整性检验。MAC计算使用安全的hash函数（例如SHA-1等等）。记录协议操作可以没有MAC，但通常只有另一个协议正在使用记录协议进行安全参数的交换时使用这种模式。

TLS记录协议用于封装某些更高层次的协议。TLS握手协议就是这样一种封装后的协议，它允许服务端和客户端验证对方的真实性和在传输第一个字节的数据前交换加密算法和加密key。TLS握手协议在三个方面保证连接的安全性。

- 各端的身份使用非对称的或者公钥算法（例如RSA，DSA等等）进行真实性检验。这种身份校验是可选的，但通常至少一方需要进行这种校验。

- 协商共享秘钥的过程是安全的：交换的秘钥对窃听者是不可用的，且任何未识别的连接无法获取秘钥，即使是一个能够把自己放到连接之间的攻击者也无法获取。

- 协商的过程是可靠的：没有攻击者能够在不被连接各方侦察到的情况下修改协商通信。

TLS的一大优势是它独立于应用层协议，更高层的协议可以透明的构建在TLS之上。然而，TLS协议并不会指定如何用协议来增强安全性，如何初始化TLS握手和如何解析交换的身份认证证书依赖于协议的设计者和实现者去决断。

## 1.1. 需要知道的术语

此文档中的术语 “MUST”，“MUST NOT”，“REQUIRED”，“SHALL”，“SHALL NOT”，“SHOULD”，“SHOULD NOT”，"RECOMMENDED"，“MAY”和“OPTIONAL”在[RFC 2119](https://www.rfc-editor.org/rfc/rfc2119)中做了解释。

## 1.2. 和TLS1.1版的主要差异

此文档是TLS 1.1协议的修订版，提升了协议的灵活性，尤其是对加密算法的协商过程。主要的差异点有：

- MD5/SHA-1组合的伪随机数函数（PRF）已经被加密套件指定的PRFs替换。此文档中的所有加密套件都是使用P_SHA256。

- 数字签名元素中MD5/SHA-1的组合已经被一个单独的hash函数取代，签名元素现在包括一个字段明确指定所使用的hash算法。

- 大量削减客户端和服务端指定hash算法和签名算法的能力操作能够指定使用何种hash算法和签名算法。注意这样也会放开一些之前版本签名算法和hash算法的限制

- 增加更多的数据模式来支持基于身份验证的加密。

- 扩展的定义和AES加密套件从第三方（TLSEXT和TLSAES）合并过来。

- 更严格的检查EncryptedPreMaster的版本号。

- 一些要求更加的严格。

- 数据长度校验现在依赖于加密套件（默认的仍是 12）。

- 删除了对Bleichenbacher/Klima攻防的描述。

- 很多场景下现在必须发送报警。

- 证书请求发起之后，如果没有可用的证书，客户端必须发送一个空证书列表。

- 使用TLS_RSA_WITH_AES_128_CBC_SHA算法实现加密套件是现在的强制要求。

- 增加HMAC-SHA256加密套件

- 移除IDEA和DES加密套件。它们现在已经过时了，并且会在一个单独的文档中描述。

- 对SSLv2版hello的向后兼容现在是MAY而不是SHOULD，而发送SSLv2版hello现在是SHOULD NOT。对它的支持将来也可能会变成SHOULD NOT。

- 增加了限制性的“fall-through”语法到表现语言中以便允许不同的情况有相同的编码。

- 增加了一个实现危险系数的章节。

- 一般性的说明和编辑工作。
